# Transmit Logic

Always reach a human. Nagging as a service. 


# Examples

Here's the full [alert syntax].

## Basic

Call someone, wait 5 minutes, email someone else.

```
process_definition do
  participant 'call bob', :recipient => '4155554242', :timeout => '5m'
  participant 'email Alex', :recipient => 'alex42@gmail.com'
end
```

## Advanced

Concurrently contact Sally and Phong using self-contained alert
definitions. If neither respond, call Sally again but only at night.

```
process_definition do
  define 'notify Sally' do
    participant 'IM Sally' :recipient => 'eric@example.com', :using => 'jabber', :timeout => '2m'
    participant 'SMS Sally', :recipient => '8145557438'
  end

  define 'Gripe to Phong' do
    participant 'call phong', :recipient => '7165554288'
    participant 'sms Phong', :recipient => '7165554288'
  end

  concurrence do
    subprocess 'notify Sally'
    subprocess 'Gripe to Phong'
    participant 'Call Sally', :recipient => '2065558484', :if => '${nighttime}'
  end
end
```


# Status

## Functionality

Transmit Logic provides:

* a Web interface where ops staff can define who, how and when to
contact engineers. Uses an alert-specific DSL built with [ruote]. See
[Examples](#examples)).
* a runtime environment for running those process definitions and
sending alerts.
* the ability to invoke alerts via HTTP POST, a SMTP-to-HTTP gateway, or
the Web interface. External monitoring services can invoke TxL alert
processes by sending standard email alerts.
* two-way alert handling for SMS, phone calls, emails, and SIP calls (so
recipients can respond to the alert via that delivery method)
* per-recipient accept,
actively decline it (so it continues to the
next step immediately), or halt the alert (as for a false positive)
* one-way alert delivery to many other services, like Campfire. Uses a
HTTP call to [txlogic-services] with a link back to the site.


## Status

The app itself is stable and in production use.

It was very recently open-sourced after months of internal use. The
setup process needs work, as does the documentation of it. It probably
hard-codes configuration options which don't apply in all situations.
There's lots of room for refactoring.


## Known Problems

* Jabber IM support is incomplete. It worked at one point but the
service provider removed Jabber support and the standalone XMPP handler
isn't done.


## Dependencies

* SMTP server: outbound email alerts
* [Mailgun]: inbound email-to-HTTP for accepting alerts via email (and
replies to email alerts)
* [Tropo]: phone calls (to PSTN and SIP numbers), SMS
* Standalone [txlogic-services] instance (optional): other HTTP-accessible notification destinations (such as Campfire)

Adding additional providers would be relatively easy.


# Setup

## Components

* Web interface. Rails app for defining and invoking alerts.
* [txlogic-services]: Fork of [github-services] Sinatra app for sending
one-way alerts (without response choices). Optional; only needed to
use non-core notification methods.


## Web app

### Database

Edit `database.yml` (or `database.yml.mysql` and rename it), then:

    bundle install
    rake db:migrate

### Token

Edit `config/initializers/secret_token.rb` to define a token.

### Web app emails

Define standard Rails mailer settings in `config/application.rb` or
`config/environments/<environment>.rb`.  See `config/environments/production.rb` 
for an example using `ActionMailer::Base.smtp_settings`.

The ActionMailer settings are used for emails generated by the Web app
(new user invitations). SMTP settings for sending alerts are defined
separately below, though they may be the same.

### Alerts

Edit `config/settings.yml` and provide service information. Optionally
define as environment-specific options in
`config/settings/<environment>.yml` per [rails_config].

### Optional: Enforce SSL, hostname

For production environments with SSL and a single hostname, change 
`default_url_options` in `config/settings/production.rb`.
`application_controller.rb` will also let you enforce access on only
that hostname and/or only via SSL.


# Usage

## License

[MIT]

## Patches

Send a pull request.

## Questions

Open an issue.

## Authors

* Troy Davis, <http://troy.yort.com>, [@troyd]
* Larry Marburger, [@lmarburger]


[alert syntax]: https://github.com/troy/txlogic/wiki/Alert-syntax
[txlogic-services]: https://github.com/troy/txlogic-services
[github-services]: https://github.com/github/github-services
[ruote]: http://ruote.rubyforge.org/
[Mailgun]: http://www.mailgun.com/
[Tropo]: http://tropo.com/
[rails_config]: https://github.com/railsjedi/rails_config
[MIT]: http://opensource.org/licenses/MIT
[@troyd]: http://twitter.com/troyd
[@lmarburger]: http://twitter.com/lmarburger
